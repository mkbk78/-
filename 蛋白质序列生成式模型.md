# 测试报告（要求：markdown格式写个测试报告，包括模型结构、模型性能分析、案例分析。）

# 1. 模型结构

## 1.1基本叙述

使用 PyTorch 框架编写的 LSTM 模型，用于生成蛋白质序列，并使用 FASTA 格式的数据进行训练，训练家族为pf00001，pf00257，pf02680，pf03011,pf12365,pf12366，总计18100条蛋白质序列数据进行训练。

## 1.2基本结构

模型共五层

1. **Embedding层**：1层

2. **LSTM层**：3层

3. **全连接层**：1层

   在train中添加了一层dropout，防止过拟合。

## 1.3模型结构图



## 1.4训练过程

```
下载6个家族的数据，使用txt_prepare.py进行处理，合并到data.txt并且除去家族标记如|<PF00001>|,以减少词汇表内含有除了表示开头和结尾含义1，2以外的数字。
设置维度embedding_dim = 128，hidden_dim = 256，num_layers = 3 
添加dropout层，每次训练结束后除去50%的神经元。
在gpu上训练了20轮，保存下模型。
```



# 2. 模型性能分析

将训练后的模型进行Recovery Rate指标的评估，得出

![](C:\Users\admin\Desktop\蛋白质序列生成模型\img\Snipaste_2024-08-12_04-00-03.png)

根据评估指标数据，我们可以做出以下分析：

- 恢复率为 0.2105，这意味着模型正确预测的字符数占总字符数的约 21.05%。这个恢复率相对较低，表明模型生成的序列与参考序列之间存在较大差异。

  以下是一些可能的原因：

  1. **训练数据不足**：
     - 使用更多的训练数据可以帮助模型更好地学习蛋白质序列的特征。
  2. **模型架构单一**：
     - 尝试不同的模型架构，例如增加 LSTM 层的数量或调整隐藏层的维度。
  3. **训练参数调整不当**：
     - 调整模型的训练参数，例如学习率、批量大小和训练轮数。

# 3.案例分析

以'KEQAEGEAVTATATPVV'作为开头进行生成蛋白质序列

![](C:\Users\admin\Desktop\蛋白质序列生成模型\img\Snipaste_2024-08-12_04-04-14.png)

生成结果如下

```
KEQAEGEAVTATATPVVYYUUUUUUUUUUUUUUYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYXXYYWVXXWWVUWUVXVUUUUXVVUXUUVUUVUUVXUUWX
```

与data.txt内的数据进行比对，相似度如下

![](C:\Users\admin\Desktop\蛋白质序列生成模型\img\Snipaste_2024-08-12_04-05-29.png)

## **结果与分析**

生成的序列与最相似的家族序列之间的相似度为 0.14。这个相似度相对较低，表明生成的序列与该家族序列的相似程度不高。以下是对这个结果的一些分析：

1. **低相似度**：
   - 相似度为 0.14 表明生成的序列与参考序列之间的共同特征较少。这可能是由于模型在生成过程中没有很好地捕捉到参考序列的特征，或者生成的序列与参考序列在结构上存在较大差异。
2. **生成序列的特点**：
   - 生成的序列中包含了许多重复的字符（如 `UUUUUUUUUUUUUUU` 和 `YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY`），这可能表明模型在生成过程中过度关注某些模式，而忽略了其他可能的序列特征。
3. **参考序列的特点**：
   - 参考序列（家族序列）中包含了更多的变化和多样性，这可能使得生成的序列难以与其高度匹配。

# 4.全部数据代码见：

#### [mkbk78/progen2-small-pfam-: progen2-small模型对于PF00001,PF00257,PF02680,PF12365,PF12366进行微调后的模型 (github.com)](https://github.com/mkbk78/progen2-small-pfam-)